{{- $.Scratch.Add "index" slice -}}
{{- range $index, $page := .Site.Pages  -}}
  {{- $possibleRules := "" -}}
  {{- if $page.Params.rules }}
    {{- range $key, $value := (index $page.Params.rules 0) -}}
      {{- $possibleRules = printf "%s,%s" $possibleRules $key -}}
    {{- end -}}
    {{/* // start dummy data generation logic */}}
    {{- $version := "v1" -}}
    {{- $label := "stable" -}}
    {{- if (modBool (add $index 1) 3) -}}
      {{- $version = "v2" }}
      {{- $label = "in development" }}
    {{- end -}}
    {{/* 
      // end dummy data generation logic
      // override dummy values of $version and $label using .Params.version and .Params.label respectively 
      // You can safely delete the dummy data generation logic
    */}}
    {{- $policy := index (intersect (split $possibleRules ",") site.Params.policies) 0 -}}
    {{- $category := lower $page.Params.category }}
    {{- $.Scratch.Add "index" (dict "title" $page.Title "body" $page.Params.description "link" $page.Permalink  "policy" $policy "category" $category  "version" $version "label" $label "filters" (printf "%s::%s::%s::%s" $policy $category $version $label)) -}}
  {{- end }}
{{- end -}}
{{- jsonify (uniq ($.Scratch.Get "index")) -}}